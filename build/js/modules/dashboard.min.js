"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":_typeof(t))&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":_typeof(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(exports,"__esModule",{value:!0}),exports.player2=exports.player1=void 0;var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,o,a){return o&&e(t.prototype,o),a&&e(t,a),t}}(),_character=require("./character.js"),_character2=_interopRequireDefault(_character),_sound=require("./sound.js"),_sound2=_interopRequireDefault(_sound),player1=exports.player1=new _character2["default"]("You"),player2=exports.player2=new _character2["default"]("Opponent"),Dashboard=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.components={keysItem:{w:87,a:65,s:83,d:68},playerName:document.querySelector(".player-name"),health:document.querySelector(".health"),wrapLog:document.querySelector(".logs"),elLogs:document.querySelectorAll(".logs p"),elKeys:document.querySelectorAll(".key"),messages:document.querySelector(".messages"),animateLog:document.querySelector(".log-animate"),numbersLogs:document.querySelector(".numbers-logs")},e.gameStatus=!1,e.logs=[],e.currentLog=0,e}return _inherits(t,e),_createClass(t,[{key:"attackProcess",value:function(e,t,o){e.health>0&&t.health>0&&(o(),t.health-=e.damage,e.health+=e.damage,e.timePoisoning>0?t.health-=e.poisonDamage:(e.poisonDamage=0,e.poison=!0),this.damageInfo(e),t.health<=0&&this.logInfo(t,"died"))}},{key:"round",value:function(e){var t=this,o=e.keyCode;65!==o||player1.statusSkill?68!==o||player1.statusSkill?87!==o||player1.statusSkill?83!==o||player1.statusSkill||player1.health>0&&(player1.statusSkill=!0,this.attackProcess(player1,player2,player1.poisonAttack.bind(player1)),this.opponentSet(),this.initSound(o)):player1.health>0&&player1.frozen&&(player1.useFrozen(),this.logInfo(player1,"your opponent is frozen"),this.initSound(o)):player1.health>0&&player1.potionHealth&&(player1.statusSkill=!0,player1.usePotionHealth(),this.logInfo(player1,"use potion health"),this.opponentSet(o),this.initSound(o)):player1.health>0&&(player1.statusSkill=!0,player1.timePoisoning>0&&(player1.timePoisoning-=1),this.attackProcess(player1,player2,player1.simpleAttack.bind(player1)),this.opponentSet(o),this.initSound(o));for(var a=function(e){o===parseInt(t.components.elKeys[e].getAttribute("data-key"))&&(t.components.elKeys[e].classList.add("key-active"),setTimeout(function(){t.components.elKeys[e].classList.remove("key-active")},300))},n=0;n<this.components.elKeys.length;n++)a(n);this.updateHealth()}},{key:"opponentSet",value:function(e){var t=this,o=Math.floor(2001*Math.random())+1e3;player2.health>0&&setTimeout(function(){player2.potionHealth&&Math.floor(100*Math.random())<=25&&player2.health<=50?(player2.usePotionHealth(),t.logInfo(player2,"use potion health"),t.initSound(t.components.keysItem.d),player1.statusSkill=!1):player2.frozen&&Math.floor(100*Math.random())<=25&&player2.health<=75?(player2.useFrozen(),t.initSound(t.components.keysItem.w),t.logInfo(player2,"your opponent is frozen"),setTimeout(function(){Math.floor(100*Math.random())<=35&&player2.poison?(t.attackProcess(player2,player1,player2.poisonAttack.bind(player2)),t.initSound(t.components.keysItem.s)):(player2.timePoisoning-=1,t.attackProcess(player2,player1,player2.simpleAttack.bind(player2)),t.initSound(t.components.keysItem.a)),t.updateHealth(),player1.statusSkill=!1},o)):(Math.floor(100*Math.random())<=player2.poisonChance&&player2.poison?(t.attackProcess(player2,player1,player2.poisonAttack.bind(player2)),t.initSound(t.components.keysItem.s)):(player2.timePoisoning-=1,t.attackProcess(player2,player1,player2.simpleAttack.bind(player2)),t.initSound(t.components.keysItem.a)),t.updateHealth(),player1.statusSkill=!1)},o)}},{key:"createLog",value:function(){var e=this;this.singleLog=document.createElement("p"),this.singleLog.classList.add("log_"+this.currentLog),this.logs.forEach(function(t,o){e.singleLog.innerHTML=t}),this.currentLog++,this.components.wrapLog.appendChild(this.singleLog),this.components.wrapLog.scrollTop=this.components.wrapLog.scrollHeight}},{key:"animateLog",value:function(e){var t=this,o=this.logs[this.logs.length-1],a=e.name.length+2,n=o.slice(a,o.length);this.components.animateLog.innerHTML=n,this.components.animateLog.classList.add("active"),setTimeout(function(){t.components.animateLog.classList.remove("active")},2e3)}},{key:"damageInfo",value:function(e){e.criticDamage>0&&0===e.poisonDamage?(this.logs.push(e.name+": critical damage "+e.damage),this.animateLog(e)):0===e.damage&&e.poison?(this.logs.push(e.name+": missed"),this.animateLog(e)):e.poisonDamage>0&&0===e.damage?this.logs.push(e.name+": missed and damage "+e.poisonDamage+" from poisoning"):e.poisonDamage>0&&e.criticDamage>0?this.logs.push(e.name+": critical damage "+e.damage+" and damage "+e.poisonDamage+" from poisoning"):e.poisonDamage>0?this.logs.push(e.name+": damage "+e.damage+" and damage "+e.poisonDamage+" from poisoning"):this.logs.push(e.name+": damage "+e.damage),this.createLog(),this.updateLogs()}},{key:"logInfo",value:function(e,t){this.logs.push(e.name+": "+t),this.createLog(),this.animateLog(e),this.updateLogs()}},{key:"updateHealth",value:function(){this.components.health.innerHTML=player1.health,this.components.playerName.innerHTML=player1.name}},{key:"updateLogs",value:function(){this.components.numbersLogs.innerHTML=this.currentLog+"/"+this.currentLog}},{key:"init",value:function(){this.gameStatus||document.addEventListener("keydown",this.round.bind(this),!1),this.status(),this.updateHealth(),this.updateLogs()}}]),t}(_sound2["default"]);exports["default"]=Dashboard;