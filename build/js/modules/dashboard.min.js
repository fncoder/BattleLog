"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Dashboard=void 0;var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}}(),_character=require("./character.js"),_character2=_interopRequireDefault(_character),Dashboard=exports.Dashboard=function(){function e(){_classCallCheck(this,e),this.components={keysItem:{w:87,a:65,s:83,d:68},playerName:document.querySelector(".player-name"),health:document.querySelector(".health"),wrapLog:document.querySelector(".logs"),elLogs:document.querySelectorAll(".logs p"),elKeys:document.querySelectorAll(".key"),messages:document.querySelector(".messages"),animateLog:document.querySelector(".log-animate"),numbersLogs:document.querySelector(".numbers-logs")},this.gameStatus=!1,this.logs=[],this.currentLog=0}return _createClass(e,[{key:"attackProcess",value:function(e,t){e.health>0&&t.health>0&&(e.simpleAttack(),t.health-=e.damage,e.health+=e.damage,this.damageInfo(e),t.health<=0&&this.diedInfo(t)),this.gameStatus=!0}},{key:"round",value:function(e){var t=this,a=e.keyCode,o=Math.floor(2001*Math.random())+1e3;!this.gameStatus&&65==a&&player1.statusSkill&&(player1.health>0&&this.attackProcess(player1,player2),player2.health>0&&setTimeout(function(){player2.potionHealth&&Math.floor(100*Math.random())<=25&&player2.health<=50?(player2.usePotionHealth(),t.potionInfo(player2)):player2.frozen&&Math.floor(100*Math.random())<=25&&player2.health<=50?(player2.useFrozen(),t.frozenInfo(player2),player1.statusSkill=!1,setTimeout(function(){t.attackProcess(player2,player1),t.updateHealth(),player1.statusSkill=!0,t.gameStatus=!1},o)):(t.attackProcess(player2,player1),t.updateHealth()),t.gameStatus=!1},o)),!this.gameStatus&&68==a&&player1.statusSkill&&player1.potionHealth&&(player1.usePotionHealth(),this.potionInfo(player1),player1.statusSkill=!1,setTimeout(function(){t.attackProcess(player2,player1),t.updateHealth(),player1.statusSkill=!0,t.gameStatus=!1},o)),!this.gameStatus&&87==a&&player1.statusSkill&&player1.frozen&&(player1.useFrozen(),this.frozenInfo(player1));for(var s=function(e){a==parseInt(t.components.elKeys[e].getAttribute("data-key"))&&(t.components.elKeys[e].classList.add("key-active"),setTimeout(function(){t.components.elKeys[e].classList.remove("key-active")},300))},n=0;n<this.components.elKeys.length;n++)s(n);this.updateHealth(),this.chatScroll()}},{key:"createLog",value:function(){var e=this;this.singleLog=document.createElement("p"),this.singleLog.classList.add("log_"+this.currentLog),this.logs.forEach(function(t,a){e.singleLog.innerHTML=t}),this.currentLog++,this.components.wrapLog.appendChild(this.singleLog)}},{key:"damageInfo",value:function(e){e.criticDamage>0?(this.logs.push(e.name+": critical damage "+e.damage),this.animateLog(e)):0==e.damage?(this.logs.push(e.name+": missed"),this.animateLog(e)):this.logs.push(e.name+": damage "+e.damage),this.createLog(),this.updateLogs(),this.chatScroll()}},{key:"potionInfo",value:function(e){this.logs.push(e.name+": use potion health"),this.createLog(),this.animateLog(e),this.updateLogs(),this.chatScroll()}},{key:"frozenInfo",value:function(e){this.logs.push(e.name+": your opponent is frozen"),this.createLog(),this.animateLog(e),this.updateLogs(),this.chatScroll()}},{key:"diedInfo",value:function(e){this.logs.push(e.name+": died"),this.animateLog(e),this.createLog(),this.updateLogs(),this.chatScroll()}},{key:"updateHealth",value:function(){this.components.health.innerHTML=player1.health,this.components.playerName.innerHTML=player1.name}},{key:"updateLogs",value:function(){this.components.numbersLogs.innerHTML=this.currentLog+"/"+this.currentLog}},{key:"animateLog",value:function(e){var t=this,a=this.logs[this.logs.length-1],o=e.name.length+2,s=a.slice(o,a.length);this.components.animateLog.innerHTML=s,this.components.animateLog.classList.add("active"),setTimeout(function(){t.components.animateLog.classList.remove("active")},2e3)}},{key:"chatScroll",value:function(){this.components.wrapLog.scrollTop=this.components.wrapLog.scrollHeight}},{key:"init",value:function(){this.gameStatus||document.addEventListener("keydown",this.round.bind(this),!1),this.updateHealth(),this.updateLogs()}}]),e}(),player1=new _character2["default"]("You"),player2=new _character2["default"]("Opponent");